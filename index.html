<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Valent√Ωn</title>

<style>
:root{
  --bg1:#ffe6ee;
  --bg2:#fff6fa;
  --card: rgba(255,255,255,.86);
}

*{box-sizing:border-box;}
html,body{height:100%;}

body{
  margin:0;
  overflow:hidden;
  font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: radial-gradient(1100px 700px at 50% 0%, var(--bg2), var(--bg1));
  display:grid;
  place-items:center;
}

/* =============== LOADER =============== */
#loader{
  position:fixed;
  inset:0;
  background: radial-gradient(circle,var(--bg2),var(--bg1));
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:9999;
  transition:opacity .6s ease, visibility .6s ease;
}
.loader-heart{ font-size:40px; animation:pulse 1s infinite; }
@keyframes pulse{ 0%,100%{transform:scale(1);} 50%{transform:scale(1.2);} }
.loader-text{ margin-top:10px; font-weight:600; }
#loader.hidden{ opacity:0; visibility:hidden; }

/* =============== LAYERS =============== */
#confetti{ position:fixed; inset:0; pointer-events:none; z-index:1; }
#tanynyLayer{ position:fixed; inset:0; pointer-events:none; z-index:4; } /* above dog/button */

/* =============== CONTENT =============== */
.card{
  width:min(360px, 92vw);
  background:var(--card);
  border-radius:18px;
  box-shadow:0 10px 26px rgba(0,0,0,.14);
  padding:16px 14px;
  text-align:center;
  backdrop-filter: blur(6px);
  border: 1px solid rgba(255,255,255,.6);
  z-index:2;
}

h1{ margin:0 0 12px; font-size: clamp(22px, 6vw, 30px); }

.btns{ display:flex; gap:10px; justify-content:center; }

button{
  padding:10px 16px;
  font-size: clamp(16px, 4.2vw, 18px);
  border:none;
  border-radius:999px;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
}

#yesBtn{ background:#ff4d7d; color:white; }
#noBtn{ background:white; }

.msg{
  margin-top:12px;
  min-height:28px;
  font-size: clamp(18px, 5vw, 22px);
  font-weight:800;
}

/* Lama3 above card */
#lama3Wrap{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  top: max(10px, env(safe-area-inset-top));
  z-index:3;
  display:none;
  width:min(220px, 55vw);
  text-align:center;
}
#lama3{
  width:100%;
  height:auto;
  filter: drop-shadow(0 14px 18px rgba(0,0,0,.18));
  transform-origin: 50% 80%;
}
@keyframes dance {
  0%   { transform: rotate(-10deg) translateY(0); }
  50%  { transform: rotate(10deg)  translateY(-4px); }
  100% { transform: rotate(-10deg) translateY(0); }
}
#lama3.dance{ animation: dance .55s ease-in-out infinite; }

/* LAMAS */
.llama{
  position:fixed;
  width:210px;
  pointer-events:none;
  z-index:0;
  transition:.5s ease;
}
.llama-right{
  right:-115px;
  bottom:-110px;
  transform: translate(-18px,-18px) rotate(-8deg);
}
.llama-left{
  left:-115px;
  bottom:-110px;
  transform: translate(18px,-18px) rotate(8deg);
}

/* DOG */
#dog{
  position:fixed;
  width:120px;
  opacity:0;
  pointer-events:none;
  z-index:3;
  will-change:left, top, opacity, transform;
}

/* TANYNY pop text */
.tanyny{
  position:absolute;
  font-weight:900;
  font-size: clamp(18px, 6vw, 34px);
  letter-spacing: 1px;
  color: rgba(255, 77, 125, .95);
  text-shadow: 0 8px 18px rgba(0,0,0,.14);
  transform: translate(-50%, -50%) scale(.9);
  opacity:0;
  animation: tanynyPop 1.25s ease-out forwards;
  user-select:none;
  white-space:nowrap;
}
@keyframes tanynyPop{
  0%   { opacity:0; transform: translate(-50%,-50%) scale(.75); }
  15%  { opacity:1; transform: translate(-50%,-50%) scale(1); }
  100% { opacity:0; transform: translate(-50%,-80%) scale(1.06); }
}
</style>
</head>

<body>

<!-- LOADER -->
<div id="loader">
  <div class="loader-heart">üíñ</div>
  <div class="loader-text">Naƒç√≠t√°m p≈ôekvapen√≠...</div>
</div>

<canvas id="confetti"></canvas>
<div id="tanynyLayer"></div>

<div id="lama3Wrap" aria-hidden="true">
  <img id="lama3" src="lama3.png" alt="">
</div>

<img id="llama" class="llama llama-right" src="lama1.png" alt="">
<img id="dog" src="pejsek.png" alt="">

<div class="card">
  <h1>Bude≈° m≈Øj Valent√Ωn?</h1>
  <div class="btns" id="buttons">
    <button id="yesBtn" type="button">ANO</button>
    <button id="noBtn" type="button">NE</button>
  </div>
  <div class="msg" id="msg"></div>
</div>

<script>
/* =============== PRELOAD =============== */
function preloadImages(sources){
  return Promise.all(
    sources.map(src => new Promise((resolve)=>{
      const img = new Image();
      img.src = src;
      img.onload = resolve;
      img.onerror = resolve;
    }))
  );
}
window.addEventListener("load", async ()=>{
  await preloadImages(["lama1.png","lama2.png","lama3.png","pejsek.png"]);
  document.getElementById("loader").classList.add("hidden");
});

/* =============== LOGIC =============== */
const llama = document.getElementById('llama');
const dog   = document.getElementById('dog');
const yesBtn = document.getElementById('yesBtn');
const noBtn  = document.getElementById('noBtn');
const msg    = document.getElementById('msg');
const buttons = document.getElementById('buttons');

const lama3Wrap = document.getElementById('lama3Wrap');
const lama3Img  = document.getElementById('lama3');
const tanynyLayer = document.getElementById('tanynyLayer');

let noUsed = false;
let tanynyTimer = null;

noBtn.addEventListener('click', ()=>{
  if(noUsed) return;
  noUsed = true;

  // P≈ôepnut√≠ lamy na lama2 vlevo dole
  llama.src = "lama2.png";
  llama.classList.remove("llama-right");
  llama.classList.add("llama-left");

  const rect = noBtn.getBoundingClientRect();
  const dogW = 120;

  // Pejsek start zleva -> k tlaƒç√≠tku -> uteƒçe doprava
  dog.style.opacity = "1";
  dog.style.top = rect.top + "px";
  dog.style.left = (-dogW - 60) + "px";
  dog.style.transform = "scaleX(1)"; // ƒçum√°k doprava

  // Bƒõh k tlaƒç√≠tku
  dog.style.transition = "left 1.2s ease";
  setTimeout(()=>{ dog.style.left = (rect.left - 10) + "px"; }, 50);

  // Zmizen√≠ tlaƒç√≠tka
  setTimeout(()=>{
    noBtn.style.transition = "opacity .15s ease, transform .15s ease";
    noBtn.style.opacity="0";
    noBtn.style.transform="scale(0.92)";
    setTimeout(()=> noBtn.classList.add("hidden"), 170);
  }, 1200);

  // √ötƒõk doprava
  setTimeout(()=>{
    dog.style.transition="left 1.6s linear";
    dog.style.left = (window.innerWidth + dogW + 80) + "px";
  }, 1400);

  // Zmiz√≠ mimo obrazovku
  setTimeout(()=>{ dog.style.opacity="0"; }, 2800);
});

/* =============== CONFETTI =============== */
const canvas = document.getElementById('confetti');
const ctx = canvas.getContext('2d');

function resizeCanvas(){
  canvas.width = Math.floor(window.innerWidth * devicePixelRatio);
  canvas.height = Math.floor(window.innerHeight * devicePixelRatio);
  canvas.style.width = window.innerWidth + 'px';
  canvas.style.height = window.innerHeight + 'px';
  ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

function runConfetti(durationMs=5500){
  const pieces = [];
  const count = Math.min(140, Math.floor(window.innerWidth / 3));
  const W = window.innerWidth;
  const H = window.innerHeight;

  for(let i=0;i<count;i++){
    pieces.push({
      x: Math.random()*W,
      y: -20 - Math.random()*H*0.4,
      w: 6 + Math.random()*6,
      h: 8 + Math.random()*10,
      vy: 2 + Math.random()*4,
      vx: -1.2 + Math.random()*2.4,
      rot: Math.random()*Math.PI,
      vr: -0.12 + Math.random()*0.24,
      r: 180 + Math.floor(Math.random()*75),
      g: 120 + Math.floor(Math.random()*110),
      b: 150 + Math.floor(Math.random()*105),
      a: 0.9
    });
  }

  const start = performance.now();
  function frame(t){
    const elapsed = t - start;
    ctx.clearRect(0,0,W,H);

    for(const p of pieces){
      p.x += p.vx; p.y += p.vy; p.rot += p.vr;
      if(p.x < -40) p.x = W+40;
      if(p.x > W+40) p.x = -40;

      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.rot);
      ctx.fillStyle = `rgba(${p.r},${p.g},${p.b},${p.a})`;
      ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
      ctx.restore();
    }

    if(elapsed < durationMs) requestAnimationFrame(frame);
    else ctx.clearRect(0,0,W,H);
  }
  requestAnimationFrame(frame);
}

/* =============== TANYNY POPS =============== */
function spawnTanyny(){
  const el = document.createElement('div');
  el.className = 'tanyny';
  el.textContent = 'TANYNY!';

  const pad = 20;
  const x = pad + Math.random() * (window.innerWidth - pad*2);
  const y = pad + Math.random() * (window.innerHeight - pad*2);

  el.style.left = x + 'px';
  el.style.top  = y + 'px';

  // Slight random rotation for fun
  const rot = (-12 + Math.random()*24).toFixed(1);
  el.style.transform = `translate(-50%,-50%) rotate(${rot}deg) scale(.9)`;

  tanynyLayer.appendChild(el);
  setTimeout(()=> el.remove(), 1300);
}

function startTanynyBurst(ms=5500){
  // spawn a bunch quickly, then slow down a bit
  const start = performance.now();

  // immediate burst
  for(let i=0;i<10;i++) setTimeout(spawnTanyny, i*90);

  // ongoing pops
  tanynyTimer = setInterval(()=>{
    spawnTanyny();
    if (Math.random() > 0.6) spawnTanyny();
    if (performance.now() - start > ms){
      clearInterval(tanynyTimer);
      tanynyTimer = null;
    }
  }, 260);
}

/* =============== YES =============== */
yesBtn.addEventListener("click",()=>{
  msg.textContent="Miluju tƒõ! üíñ";
  buttons.classList.add("hidden");

  // show dancing lama3 above card
  lama3Wrap.style.display = "block";
  lama3Img.classList.add("dance");

  // effects
  runConfetti(5500);
  startTanynyBurst(5500);
});
</script>

</body>
</html>
